"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decrypt = exports.encrypt = void 0;
const deps_js_1 = require("../deps.js");
/**
 * Encrypt a string or object value
 *
 * @param password Random string at least 32 characters long
 * @param payload String or object to encrypt
 * @returns A promise of the encrypted string
 */
async function encrypt(password, payload) {
    return await deps_js_1.Iron.seal(globalThis.crypto, payload, password, deps_js_1.Iron.defaults);
}
exports.encrypt = encrypt;
/**
 * Decrypt an encrypted payload
 *
 * @param password Random string at least 32 characters long
 * @param encrypted Encrypted string
 * @returns Promise of the unencrypted value (string or object in most cases)
 */
async function decrypt(password, encrypted) {
    return await deps_js_1.Iron.unseal(globalThis.crypto, encrypted, { default: password }, deps_js_1.Iron.defaults);
}
exports.decrypt = decrypt;
